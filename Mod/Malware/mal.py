#! /usr/bin/env python3

## Malware Submenu
import os
import importlib
from importlib import util

spec = importlib.util.find_spec('.subserv', package='lib')
m = spec.loader.load_module()

spec1 = importlib.util.find_spec('.ven', package='Mod.Malware.venom')
v = spec1.loader.load_module()

spec2 = importlib.util.find_spec('.rs32', package='Mod.Malware.regsrv32')
r32 = spec2.loader.load_module()

spec3 = importlib.util.find_spec('.idns', package='Mod.Malware.ICMP-DNS')
dni = spec3.loader.load_module()

spec4 = importlib.util.find_spec('.instutil', package='Mod.Malware.installutil')
iu = spec4.loader.load_module()

spec5 = importlib.util.find_spec('.msb', package='Mod.Malware.MSBuild')
ms = spec5.loader.load_module()

spec6 = importlib.util.find_spec('.phost', package='Mod.Malware.P-Host')
ph = spec6.loader.load_module()

spec7 = importlib.util.find_spec('.mac', package='Mod.Malware.Mac')
mac = spec7.loader.load_module()

spec8 = importlib.util.find_spec('.rega', package='Mod.Malware.regasm')
ra = spec8.loader.load_module()

spec9 = importlib.util.find_spec('.rsvc', package='Mod.Malware.regsvcs')
rs = spec9.loader.load_module()

spec10 = importlib.util.find_spec('.customal', package='Mod.Malware')
c = spec10.loader.load_module()

## Malware Sub-menu
def Malware():
  os.system("clear")
  print(m.bcolors.GREEN + m.bcolors.BOLD + m.bcolors.UNDERLINE + "\tMALWARE TIME!!!!!" + m.bcolors.ENDC)
  while(1):
    print(m.bcolors.BLUE + "\t*******************************************************************" + m.bcolors.ENDC)
    print(m.bcolors.BOLD + m.bcolors.BLUE +"""
        *******************************************************************
          _   _   _   _   _   _   _     _   _   _   _  
         / \ / \ / \ / \ / \ / \ / \   / \ / \ / \ / \ 
        ( M | a | l | w | a | r | e ) ( M | e | n | u )
         \_/ \_/ \_/ \_/ \_/ \_/ \_/   \_/ \_/ \_/ \_/ 
      """+ m.bcolors.ENDC)

    print(m.bcolors.ERROR + "\t*******************************************************************" + m.bcolors.ENDC)
    print("\t(1)\tGenerate all Malware-----(this would be for a malware test)")
    print("\t(2)\tGenerate only Bypass-----(this would be for Pen test)")
    print("\t(3)\tGenerate Marantal the Mantroll Special-----(my fav stuff)")
    print("\t(4)\tGenerate only Malware that does not use Meterpreter")
    print("\t(5)\tGenerate only MAC and Python Malware ")
    print("\t(10)\tCustomize Malware (Manual Ports etc..)")
    print("\t(99)\tGo back to the main menu")
    print(m.bcolors.BLUE + "\t*******************************************************************" + m.bcolors.ENDC)

    options = input("\nW4@+ Ma1w@r3 R U W@^t1ng Brobi-Wan: ")
    if options == "1":
       m.archFile()
       v.gen_000()
       v.gen_010()
       v.gen_020()
       mac.gen_100()
       mac.gen_200()
       mac.gen_201()
       mac.gen_210()
       dni.gen_300()
       r32.gen_320()
       r32.gen_330()
       r32.gen_340()
       r32.gen_350()
       iu.gen_400()
       iu.gen_401()
       ms.gen_410()
       ph.gen_420()
       ra.gen_430()
       ra.gen_431()
       rs.gen_440()
       rs.gen_441()
       m.rc_file()
       print(m.bcolors.ERROR + "**Payloads, batch and RC files are located\n**In: " + m.targetfile + m.bcolors.ENDC)
    elif options == "2":
       m.archFile()
       dni.gen_300()
       r32.gen_320()
       r32.gen_330()
       r32.gen_340()
       r32.gen_350()
       iu.gen_400()
       iu.gen_401()
       ms.gen_410()
       ph.gen_420()
       ra.gen_430()
       ra.gen_431()
       rs.gen_440()
       rs.gen_441()
       m.rc_file()
       print(m.bcolors.ERROR + "**Payloads, batch and RC files are located\n**In: " + m.targetfile + m.bcolors.ENDC)
    elif options == "3":
       m.archFile()
       iu.gen_400()
       iu.gen_401()
       ms.gen_410()
       ph.gen_420()
       ra.gen_430()
       ra.gen_431()
       rs.gen_440()
       rs.gen_441()
       m.rc_file()
       print(m.bcolors.ERROR + "**Payloads, batch and RC files are located\n**In: " + m.targetfile + m.bcolors.ENDC)
    elif options == "4":
       m.archFile()
       v.gen_020()
       r32.gen_340()
       r32.gen_350()
       iu.gen_400()
       ra.gen_431()
       rs.gen_441()
       m.rc_file()
       print(m.bcolors.ERROR + "**Payloads, batch and RC files are located\n**In: " + m.targetfile + m.bcolors.ENDC)
    elif options == "5":
       m.archFile()
       mac.gen_100()
       mac.gen_200()
       mac.gen_201()
       mac.gen_210()
       m.rc_file()
       print(m.bcolors.ERROR + "**Payloads, batch and RC files are located\n**In: " + m.targetfile + m.bcolors.ENDC)
    elif options == "10":
       c.custom()
    elif options == "99":
       os.system("clear")
       break
    else:
       input("You must be a Pats Fan! Come on pick something... ")